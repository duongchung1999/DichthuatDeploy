(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7792:function(e,a,t){Promise.resolve().then(t.bind(t,185))},185:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return v}});var i=t(7437),s=t(2265),c=t(7073),n=t(5606),l=t(9768),r=t(9782),m=t(1213),o=t(7138);t(5103);var d=t(5749),h=t(6648);let u=s.memo(e=>{var a;let[t,c]=(0,s.useState)(!1),[n,l]=(0,s.useState)("");return(0,i.jsxs)("div",{className:"itemCard-container-dashboard",onClick:e.cardClick,onMouseEnter:e.cardClick,children:[(0,i.jsxs)("div",{className:"itemCard-UserName",children:[(0,i.jsxs)("div",{className:"itemCard-UserName-1",children:[(0,i.jsx)(h.default,{src:e.imgUser?e.imgUser:d.Z,alt:"img",width:50,height:50}),(0,i.jsxs)("div",{className:"itemCard-UserName-container",children:[(0,i.jsx)("h4",{className:"username-card",children:e.username}),(0,i.jsx)("p",{style:{margin:"0"},children:(e=>{if(!e)return"";try{let a=new Date(e);return(0,r.WU)(a,"h:mm a, dd 'Th\xe1ng' MM, yyyy",{locale:m.vi})}catch(a){return console.error("Invalid date format:",e),e}})(e.dateTime)})]})]}),(0,i.jsx)("div",{className:"itemCard-UserName-1",children:(0,i.jsx)("button",{className:"btn btn-options",onClick:e.removeClick,style:{padding:"0",margin:"0"},children:(0,i.jsx)("i",{className:"fa-solid fa-trash"})})})]}),(0,i.jsx)("div",{className:"itemCard-baiDich",children:e.img?(0,i.jsx)("pre",{children:(a=e.baidich)&&a.length>300?(0,i.jsxs)(i.Fragment,{children:[a.substring(0,300),"...",(0,i.jsx)("span",{className:"see-more",children:(0,i.jsx)(o.default,{href:e.link,legacyBehavior:!0,children:(0,i.jsx)("a",{children:"xem th\xeam"})})})]}):a}):(0,i.jsx)("pre",{children:e.baidich})}),e.img&&(0,i.jsx)(o.default,{href:e.link,passHref:!0,legacyBehavior:!0,children:(0,i.jsx)("a",{className:"itemCard-title-dashboard",onClick:e.cardClick,children:(0,i.jsx)(h.default,{src:e.img,alt:"null",width:500,height:500})})}),(0,i.jsxs)("div",{className:"itemCard-content",children:[e.img&&(0,i.jsx)("h3",{className:"itemCard-content-title",children:e.title}),e.img&&(0,i.jsx)("div",{className:"itemCard-content-description",children:(0,i.jsx)("span",{children:e.tieudeTiengTrung})}),(0,i.jsxs)("div",{className:"ItemCard-dashboard-footer",children:[(0,i.jsxs)("div",{className:"ItemCard-interact",children:[(0,i.jsxs)("div",{className:"ItemCard-interact-likeview",children:[(0,i.jsx)("div",{className:"liked-view",children:(0,i.jsx)("i",{className:"fa-solid fa-thumbs-up"})}),(0,i.jsx)("span",{className:"ItemCard-interact-liked",children:(0,i.jsx)("div",{children:e.likes})})]}),(0,i.jsx)("hr",{}),(0,i.jsxs)("div",{className:"row",children:[(0,i.jsx)("div",{className:"col-6 ItemCard-interact-item",onClick:()=>{c(!t),e.likeClick()},children:(0,i.jsxs)("div",{className:"ItemCard-interact-item-flex ".concat(e.isLiked?"liked":""),children:[(0,i.jsx)("i",{className:"fa-regular fa-thumbs-up ".concat(e.isLiked?"liked-icon":"")}),(0,i.jsx)("span",{children:"Th\xedch"})]})}),(0,i.jsx)("div",{className:"col-6 ItemCard-interact-item",onClick:e.cmtClick,children:(0,i.jsxs)("div",{className:"ItemCard-interact-item-flex",children:[(0,i.jsx)("i",{className:"fa-regular fa-comment"}),(0,i.jsx)("span",{children:"B\xecnh luận"})]})})]})]}),(0,i.jsx)("div",{className:"itemCard-comment",children:(0,i.jsxs)("div",{className:"itemCard-comment-container",children:[(0,i.jsx)("div",{className:"itemCard-comment-viewer",children:e.comment}),(0,i.jsxs)("div",{className:"itemCard-comment-write",children:[(0,i.jsx)("div",{className:"itemCard-user-image",children:(0,i.jsx)(h.default,{src:e.imgUser?e.imgUser:d.Z,alt:"img",width:500,height:500})}),(0,i.jsxs)("div",{className:"comment-input-container",children:[(0,i.jsx)("textarea",{className:"form-control comment-input",name:e.name,"aria-describedby":"helpId",placeholder:"B\xecnh luận với vai tr\xf2 "+e.username,onChange:a=>{l(a.target.value),e.onChangeHandle&&e.onChangeHandle(a)},value:n}),(0,i.jsx)("div",{className:"itemCard-comment-send  ".concat(n?"active1":"no-item"),onClick:e.sendCmtHandle,children:(0,i.jsx)("i",{className:"fa-solid fa-paper-plane"})})]})]})]})})]})]})]})});u.displayName="ItemCardDashboard";var g=t(3508);t(7663);var k=e=>{let{likes:a}=e,[t,c]=(0,s.useState)(!1),[n,l]=(0,s.useState)(!1);(0,s.useEffect)(()=>{m()});let r=localStorage.getItem("name"),m=()=>{a&&a.map(e=>{e.username===r&&l(!0)})};return(0,i.jsxs)("div",{className:"likeView-controller",children:[(0,i.jsx)("div",{className:"likeView-header",onClick:()=>{c(!t)},children:a[0]?(n?"Bạn":a[0].username)+(a[1]?" v\xe0 "+(a.length-1)+" người kh\xe1c":""):null}),(0,i.jsx)("div",{className:t?"likeView-detailes":"hidden",children:a&&a.map((e,a)=>(0,i.jsx)("div",{className:"liked-user",children:(0,i.jsx)("span",{children:e.username})},a))})]})};t(1656),t(594);class x extends s.Component{componentDidMount(){this.getData()}render(){return(0,i.jsx)(c.Z,{body:(0,i.jsxs)("div",{className:"container",children:[this.showBaidich(),this.state.loading?(0,i.jsx)(l.Z,{}):null]})})}constructor(e){var a;super(e),a=this,this.getData=async()=>{this.setState({loading:!0});let e=localStorage.getItem("user"),a=localStorage.getItem("name"),t="/users/dashboard",i="/users/account";try{let s=await (0,n.UD)(t),c=await Promise.all(s.map(async a=>{let s=a.key,c=await (0,n.UD)("".concat(t,"/").concat(s)),l=await Promise.all(c.map(async a=>{let c="".concat(s,"&").concat(a.key),[l,r,m,o,d,h,u,g,k,x,v,y,j]=await Promise.all([(0,n.UD)("".concat(t,"/").concat(s,"/").concat(a.key,"/comment")),(0,n.UD)("".concat(t,"/").concat(s,"/").concat(a.key,"/like")),(0,n.eO)("".concat(t,"/").concat(s,"/name")),(0,n.eO)("".concat(i,"/").concat(s,"/img")),(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/tieude")),(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/tieudeTiengTrung")),(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/author")),(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/imgAuthor")),(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/link")),(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/weblink")),(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/dateTime")),(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/id")),(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/baidich"))]),f=null,C=null,N=!1;return l&&(f=await Promise.all(l.map(async e=>{let c=await (0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/comment/").concat(e.key,"/user")),[l,r,m,o]=await Promise.all([(0,n.eO)("".concat(i,"/").concat(c,"/name")),(0,n.eO)("".concat(i,"/").concat(c,"/img")),(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/comment/").concat(e.key,"/cmt")),(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/comment/").concat(e.key,"/dateTime"))]);return{username:l,userImage:r,cmt:m,dateTime:o,id:e.key}}))),r&&(C=await Promise.all(r.map(async i=>{i.key===e&&(N=!0);let[c,l]=await Promise.all([(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/like/").concat(i.key,"/name")),(0,n.eO)("".concat(t,"/").concat(s,"/").concat(a.key,"/like/").concat(i.key,"/image"))]);return{username:c,userImage:l}}))),{baivietKey:c,username:m,userImage:o,tieude:d,tieudeTiengTrung:h,author:u,imgAuthor:g,link:k,weblink:x,dateTime:v,comment:f,likes:C,id:y,baidich:j,isLiked:N}}));return{key:s,baivietDatas:l}})),l=[];c.forEach(e=>{l=l.concat(e.baivietDatas)}),l.sort((e,a)=>new Date(a.dateTime)-new Date(e.dateTime));let r={},m={},o={},d={},h={},u={},g={},k={},x={},v={},y={},j={},f={},C={};l.forEach(e=>{r[e.baivietKey]=e.weblink,m[e.baivietKey]=e.tieudeTiengTrung,o[e.baivietKey]=e.author,d[e.baivietKey]=e.link,h[e.baivietKey]=e.imgAuthor,u[e.baivietKey]=e.username,k[e.baivietKey]=e.tieude,g[e.baivietKey]=e.dateTime,x[e.baivietKey]=e.comment,v[e.baivietKey]=e.likes,y[e.baivietKey]=e.id,j[e.baivietKey]=e.userImage,f[e.baivietKey]=e.baidich,C[e.baivietKey]=e.isLiked}),this.setState({datas:l,myUser:e,MyUserName:a,baidichs:f,weblinks:r,tieudeTiengTrungs:m,authors:o,imgAuthors:h,links:d,usernames:u,userImages:j,tieudes:k,dateTimes:g,comments:x,likes:v,ids:y,isLikedMap:C,loading:!1})}catch(e){this.setState({error:e,loading:!1}),console.error("Error fetching data:",e)}},this.removeClick=async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(await (0,n.Z6)(e),i){let i=e.split("/").pop();a.setState(e=>({comments:{...e.comments,[t]:e.comments[t].filter(e=>e.id!==i)}}))}else a.setState(e=>({datas:e.datas.filter(e=>e.baivietKey!==t),baidichs:a.filterOutKey(e.baidichs,t),weblinks:a.filterOutKey(e.weblinks,t),tieudeTiengTrungs:a.filterOutKey(e.tieudeTiengTrungs,t),authors:a.filterOutKey(e.authors,t),imgAuthors:a.filterOutKey(e.imgAuthors,t),links:a.filterOutKey(e.links,t),usernames:a.filterOutKey(e.usernames,t),userImages:a.filterOutKey(e.userImages,t),tieudes:a.filterOutKey(e.tieudes,t),dateTimes:a.filterOutKey(e.dateTimes,t),comments:a.filterOutKey(e.comments,t),likes:a.filterOutKey(e.likes,t),ids:a.filterOutKey(e.ids,t)}))},this.filterOutKey=(e,a)=>{let{[a]:t,...i}=e;return i},this.sendCmtHandle=async(e,a)=>{let t=this.state.commentTexts[a],i=localStorage.getItem("user"),s=localStorage.getItem("name"),c=localStorage.getItem("userImage");if(i){let l="".concat(e,"/comment"),r=await (0,n.UD)(l),m=new Date().toISOString(),o=null;o=r?r.length+1:1;let d="".concat(o,"-").concat((0,g.o)(m));await (0,n.Pf)("".concat(l,"/").concat(d,"/user"),i),await (0,n.Pf)("".concat(l,"/").concat(d,"/cmt"),t),await (0,n.Pf)("".concat(l,"/").concat(d,"/dateTime"),m);let h={username:s,userImage:c,cmt:t,dateTime:m,id:d};this.setState(e=>({comments:{...e.comments,[a]:[...e.comments[a]||[],h]},commentTexts:{...e.commentTexts,[a]:""}}))}},this.likeClick=async(e,a,t)=>{let i=localStorage.getItem("user"),s=localStorage.getItem("name"),c=localStorage.getItem("userImage");if(i){let l="".concat(e,"/like");if(t)await (0,n.Z6)("".concat(l,"/").concat(i)),this.setState(e=>({likes:{...e.likes,[a]:e.likes[a].filter(e=>e.username!==s)},isLikedMap:{...e.isLikedMap,[a]:!1}}));else{await (0,n.Pf)("".concat(l,"/").concat(i,"/name"),s),await (0,n.Pf)("".concat(l,"/").concat(i,"/image"),c);let e={username:s,userImage:c};this.setState(t=>({likes:{...t.likes,[a]:[...t.likes[a]||[],e]},isLikedMap:{...t.isLikedMap,[a]:!0}}))}}},this.handleCommentChange=(e,a)=>{this.setState(t=>({commentTexts:{...t.commentTexts,[e]:a.target.value}}))},this.showBaidich=()=>{let{datas:e,baidichs:a,userImages:t,usernames:s,commentTexts:c,likes:n,dateTimes:l,comments:r,tieudes:m,tieudeTiengTrungs:o,ids:d,isLikedMap:h}=this.state;return e&&e.length>0?e.map((e,g)=>{let x=e.baivietKey,v=x.split("&")[0],y="/users/dashboard/".concat(v,"/").concat(x.split("&")[1]);return(0,i.jsx)(u,{username:s[x]||null,dateTime:l[x]||null,imgUser:t[x]||null,comment:r[x]?this.showComment(y,r[x],x):null,likes:n[x]?(0,i.jsx)(k,{likes:n[x]}):null,tieudeTiengTrung:o[x]||null,link:x?"/dashboard/".concat(v,"/").concat(x.split("&")[1]):null,title:m[x]||null,baidich:a[x]||null,img:d[x]?"https://img.youtube.com/vi/".concat(d[x],"/sddefault.jpg"):null,removeClick:()=>this.removeClick(y,x,!1),sendCmtHandle:()=>this.sendCmtHandle(y,x),commentText:c[x]||"",handleCommentChange:e=>this.handleCommentChange(x,e),likeClick:()=>this.likeClick(y,x,h[x]),isLiked:h[x]},g)}):null},this.showComment=(e,a,t)=>(0,i.jsx)("div",{children:a&&a.map((a,s)=>(0,i.jsx)(y,{imgUser:a.userImage,username:a.username,cmt:a.cmt,dateTime:a.dateTime,removeClick:()=>this.removeClick("".concat(e,"/comment/").concat(a.id),t,!0)},s))}),this.state={datas:null,usernames:null,dateTimes:null,tieudes:null,links:null,likes:null,comments:null,weblinks:null,tieudeTiengTrungs:null,authors:null,imgAuthors:null,baidichs:null,error:null,nav:!1,loading:!1,commentTexts:{},isLikedMap:{}}}}var v=x;function y(e){return(0,i.jsxs)("div",{className:"itemCard-UserName",children:[(0,i.jsxs)("div",{className:"itemCard-UserName-2",children:[(0,i.jsx)(h.default,{src:e.imgUser?e.imgUser:d.Z,alt:"img",width:500,height:500}),(0,i.jsxs)("div",{className:"itemCard-UserName-container",children:[(0,i.jsxs)("div",{className:"itemCard-UserName-container-1",children:[(0,i.jsx)("h6",{className:"username-card1",children:e.username}),(0,i.jsx)("p",{children:e.cmt})]}),(0,i.jsx)("span",{className:"Time",style:{margin:"0"},children:(0,g.o)(e.dateTime)})]})]}),(0,i.jsx)("div",{className:"itemCard-UserName-1",children:(0,i.jsx)("button",{className:"btn btn-options",onClick:e.removeClick,style:{padding:"0",margin:"0"},children:(0,i.jsx)("i",{className:"fa-solid fa-trash"})})})]})}},1656:function(){},594:function(){},5103:function(){},7663:function(){}},function(e){e.O(0,[555,296,777,312,734,320,610,461,481,138,885,648,340,386,971,23,744],function(){return e(e.s=7792)}),_N_E=e.O()}]);